#!/usr/bin/env python3
"""
Batch update all slide values
"""

import os

# Define all replacements for each slide
slide_replacements = {
    13: [  # 5 years savings
        ('$4,021.84', '$4,131.47'),
        ('$8,043.67', '$8,262.94'),
        ('$20,109.18', '$20,657.35'),
        ('$40,218.36', '$41,314.70'),
        ('-$978.16', '-$868.53'),
        ('-$1,956.33', '-$1,737.06'),
        ('-$4,890.82', '-$4,342.65'),
        ('-$9,781.64', '-$8,685.30'),
    ],
    14: [  # 10 years savings
        ('$3,668.93', '$3,767.86'),
        ('$7,337.87', '$7,535.73'),
        ('$18,344.67', '$18,839.31'),
        ('$36,689.35', '$37,678.63'),
        ('-$1,331.07', '-$1,232.14'),
        ('-$2,662.13', '-$2,464.27'),
        ('-$6,655.33', '-$6,160.69'),
        ('-$13,310.65', '-$12,321.37'),
    ],
    15: [  # 20 years savings
        ('$3,053.63', '$3,137.50'),
        ('$6,107.26', '$6,275.01'),
        ('$15,268.15', '$15,687.52'),
        ('$30,536.30', '$31,375.04'),
        ('-$1,946.37', '-$1,862.50'),
        ('-$3,892.74', '-$3,724.99'),
        ('-$9,731.85', '-$9,312.48'),
        ('-$19,463.70', '-$18,624.96'),
    ],
    16: [  # 30 years savings
        ('$2,369.22', '$2,438.87'),
        ('$4,738.45', '$4,877.74'),
        ('$11,846.11', '$12,194.35'),
        ('$23,692.23', '$24,388.69'),
        ('-$2,630.78', '-$2,561.13'),
        ('-$5,261.55', '-$5,122.26'),
        ('-$13,153.89', '-$12,805.65'),
        ('-$26,307.77', '-$25,611.31'),
    ],
    18: [  # 5 years salary
        ('$40,218.36', '$41,314.70'),
        ('$52,283.87', '$53,709.11'),
        ('$64,349.38', '$66,103.52'),
        ('$80,436.73', '$82,629.41'),
        ('$62,160.66', '$60,511.15'),
        ('$80,808.86', '$78,664.49'),
        ('$99,457.06', '$96,817.83'),
        ('$124,321.32', '$121,022.29'),
    ],
    19: [  # 10 years salary
        ('$36,689.35', '$37,678.63'),
        ('$47,696.15', '$48,982.22'),
        ('$58,702.95', '$60,285.81'),
        ('$73,378.69', '$75,357.26'),
        ('$68,139.67', '$66,350.61'),
        ('$88,581.57', '$86,255.79'),
        ('$109,023.47', '$106,160.98'),
        ('$136,279.34', '$132,701.22'),
    ],
    20: [  # 20 years salary
        ('$30,536.30', '$31,375.04'),
        ('$39,697.20', '$40,787.55'),
        ('$48,858.09', '$50,200.06'),
        ('$61,072.61', '$62,750.08'),
        ('$81,869.76', '$79,681.17'),
        ('$106,430.69', '$103,585.53'),
        ('$130,991.62', '$127,489.88'),
        ('$163,739.53', '$159,362.35'),
    ],
    21: [  # 30 years salary
        ('$23,692.23', '$24,388.69'),
        ('$30,799.89', '$31,705.30'),
        ('$37,907.56', '$39,021.91'),
        ('$47,384.45', '$48,777.39'),
        ('$105,519.84', '$102,506.51'),
        ('$137,175.80', '$133,258.46'),
        ('$168,831.75', '$164,010.42'),
        ('$211,039.69', '$205,013.02'),
    ],
    34: [  # 5 years lump sum
        ('$4,021.84', '$4,131.47'),
        ('$8,043.67', '$8,262.94'),
        ('$20,109.18', '$20,657.35'),
        ('$40,218.36', '$41,314.70'),
        ('$10,362.70', '$10,553.63'),
        ('$20,725.40', '$21,107.27'),
        ('$51,813.51', '$52,768.17'),
        ('$103,627.01', '$105,536.33'),
    ],
    35: [  # 10 years lump sum
        ('$3,668.93', '$3,767.86'),
        ('$7,337.87', '$7,535.73'),
        ('$18,344.67', '$18,839.31'),
        ('$36,689.35', '$37,678.63'),
        ('$26,618.43', '$27,232.14'),
        ('$53,236.85', '$54,464.29'),
        ('$133,092.13', '$136,160.71'),
        ('$266,184.25', '$272,321.43'),
    ],
    36: [  # 20 years lump sum
        ('$3,053.63', '$3,137.50'),
        ('$6,107.26', '$6,275.01'),
        ('$15,268.15', '$15,687.52'),
        ('$30,536.30', '$31,375.04'),
        ('$76,905.02', '$77,215.19'),
        ('$153,810.05', '$154,430.38'),
        ('$384,525.12', '$386,075.95'),
        ('$769,050.25', '$772,151.90'),
    ],
    37: [  # 30 years lump sum
        ('$2,369.22', '$2,438.87'),
        ('$4,738.45', '$4,877.74'),
        ('$11,846.11', '$12,194.35'),
        ('$23,692.23', '$24,388.69'),
        ('$210,152.21', '$177,705.98'),
        ('$420,304.41', '$355,411.95'),
        ('$1,050,761.03', '$888,529.89'),
        ('$2,101,522.06', '$1,777,059.77'),
    ],
    39: [  # 5 years DCA
        ('$6,000.00', '$6,000.00'),  # No change
        ('$15,000.00', '$15,000.00'),  # No change
        ('$30,000.00', '$30,000.00'),  # No change
        ('$60,000.00', '$60,000.00'),  # No change
        ('$5,525.21', '$4,957.76'),
        ('$13,813.02', '$12,394.41'),
        ('$27,626.04', '$24,788.82'),
        ('$55,252.09', '$49,577.64'),
        ('$9,818.05', '$8,573.35'),
        ('$24,545.11', '$21,433.38'),
        ('$49,090.23', '$42,866.77'),
        ('$98,180.45', '$85,733.53'),
    ],
    40: [  # 10 years DCA
        ('$12,000.00', '$12,000.00'),  # No change
        ('$30,000.00', '$30,000.00'),  # No change (appears twice, will handle carefully)
        ('$60,000.00', '$60,000.00'),  # No change
        ('$120,000.00', '$120,000.00'),  # No change
        ('$10,137.76', '$9,042.87'),
        ('$25,344.39', '$22,607.18'),
        ('$50,688.79', '$45,214.35'),
        ('$101,377.58', '$90,428.71'),
        ('$33,723.54', '$25,137.82'),
        ('$84,308.86', '$62,844.54'),
        ('$168,617.72', '$125,689.09'),
        ('$337,235.44', '$251,378.17'),
    ],
    41: [  # 20 years DCA
        ('$24,000.00', '$24,000.00'),  # No change
        ('$60,000.00', '$60,000.00'),  # No change
        ('$120,000.00', '$120,000.00'),  # No change
        ('$240,000.00', '$240,000.00'),  # No change
        ('$18,318.63', '$15,060.02'),
        ('$45,796.57', '$37,650.05'),
        ('$91,593.14', '$75,300.10'),
        ('$183,186.28', '$150,600.19'),
        ('$173,409.41', '$70,970.00'),
        ('$433,523.53', '$177,424.99'),
        ('$867,047.06', '$354,849.98'),
        ('$1,734,094.12', '$709,699.97'),
    ],
    42: [  # 30 years DCA
        ('$36,000.00', '$36,000.00'),  # No change
        ('$90,000.00', '$90,000.00'),  # No change
        ('$180,000.00', '$180,000.00'),  # No change
        ('$360,000.00', '$360,000.00'),  # No change
        ('$24,744.17', '$17,559.86'),
        ('$61,860.42', '$43,899.65'),
        ('$123,720.84', '$87,799.30'),
        ('$247,441.69', '$175,598.60'),
        ('$410,735.40', '$134,021.85'),
        ('$1,026,838.50', '$335,054.63'),
        ('$2,053,677.00', '$670,109.27'),
        ('$4,107,354.00', '$1,340,218.53'),
    ],
}

def update_slide(slide_num, replacements):
    """Update a slide with the given replacements"""
    slide_path = f'pptx_extracted/ppt/slides/slide{slide_num}.xml'

    if not os.path.exists(slide_path):
        print(f"Warning: {slide_path} not found")
        return False

    # Read file
    with open(slide_path, 'r', encoding='utf-8') as f:
        content = f.read()

    # Make replacements
    changes = 0
    for old, new in replacements:
        if old != new and old in content:  # Only replace if different and found
            count = content.count(old)
            content = content.replace(old, new)
            changes += count
            print(f"  Slide {slide_num}: Replaced '{old}' with '{new}' ({count} times)")

    # Write back
    with open(slide_path, 'w', encoding='utf-8') as f:
        f.write(content)

    print(f"Slide {slide_num}: {changes} replacements made")
    return True

# Update all slides
print("Updating slides...")
for slide_num, replacements in sorted(slide_replacements.items()):
    print(f"\nProcessing Slide {slide_num}...")
    update_slide(slide_num, replacements)

print("\n\nAll slides updated successfully!")
