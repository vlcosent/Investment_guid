#!/usr/bin/env python3
"""
FINAL BATCH UPDATE with CORRECTED CPI values
CPI Sep 2025 = 324.368 (NOT 314.9!)
"""

import os

# All replacements - OLD values (from previous incorrect update) -> NEW values (corrected)
slide_replacements = {
    13: [  # 5 years savings
        ('$4,131.47', '$4,011.32'),
        ('$8,262.94', '$8,022.65'),
        ('$20,657.35', '$20,056.62'),
        ('$41,314.70', '$40,113.24'),
        ('-$868.53', '-$988.68'),
        ('-$1,737.06', '-$1,977.35'),
        ('-$4,342.65', '-$4,943.38'),
        ('-$8,685.30', '-$9,886.76'),
    ],
    14: [  # 10 years savings
        ('$3,767.86', '$3,658.44'),
        ('$7,535.73', '$7,316.87'),
        ('$18,839.31', '$18,292.19'),
        ('$37,678.63', '$36,584.37'),
        ('-$1,232.14', '-$1,341.56'),
        ('-$2,464.27', '-$2,683.13'),
        ('-$6,160.69', '-$6,707.81'),
        ('-$12,321.37', '-$13,415.63'),
    ],
    15: [  # 20 years savings
        ('$3,137.50', '$3,045.92'),
        ('$6,275.01', '$6,091.85'),
        ('$15,687.52', '$15,229.62'),
        ('$31,375.04', '$30,459.23'),
        ('-$1,862.50', '-$1,954.08'),
        ('-$3,724.99', '-$3,908.15'),
        ('-$9,312.48', '-$9,770.38'),
        ('-$18,624.96', '-$19,540.77'),
    ],
    16: [  # 30 years savings
        ('$2,438.87', '$2,367.68'),
        ('$4,877.74', '$4,735.36'),
        ('$12,194.35', '$11,838.41'),
        ('$24,388.69', '$23,676.81'),
        ('-$2,561.13', '-$2,632.32'),
        ('-$5,122.26', '-$5,264.64'),
        ('-$12,805.65', '-$13,161.59'),
        ('-$25,611.31', '-$26,323.19'),
    ],
    18: [  # 5 years salary
        ('$41,314.70', '$40,113.24'),
        ('$53,709.11', '$52,147.21'),
        ('$66,103.52', '$64,181.18'),
        ('$82,629.41', '$80,226.47'),
        ('$60,511.15', '$62,323.57'),
        ('$78,664.49', '$81,020.64'),
        ('$96,817.83', '$99,717.71'),
        ('$121,022.29', '$124,647.14'),
    ],
    19: [  # 10 years salary
        ('$37,678.63', '$36,584.37'),
        ('$48,982.22', '$47,559.69'),
        ('$60,285.81', '$58,535.00'),
        ('$75,357.26', '$73,168.75'),
        ('$66,350.61', '$68,335.19'),
        ('$86,255.79', '$88,835.74'),
        ('$106,160.98', '$109,336.30'),
        ('$132,701.22', '$136,670.37'),
    ],
    20: [  # 20 years salary
        ('$31,375.04', '$30,459.23'),
        ('$40,787.55', '$39,597.00'),
        ('$50,200.06', '$48,734.77'),
        ('$62,750.08', '$60,918.46'),
        ('$79,681.17', '$82,076.92'),
        ('$103,585.53', '$106,700.00'),
        ('$127,489.88', '$131,323.08'),
        ('$159,362.35', '$164,153.85'),
    ],
    21: [  # 30 years salary
        ('$24,388.69', '$23,676.81'),
        ('$31,705.30', '$30,779.85'),
        ('$39,021.91', '$37,882.90'),
        ('$48,777.39', '$47,353.62'),
        ('$102,506.51', '$105,588.54'),
        ('$133,258.46', '$137,265.10'),
        ('$164,010.42', '$168,941.67'),
        ('$205,013.02', '$211,177.08'),
    ],
    34: [  # 5 years lump sum
        ('$4,131.47', '$4,011.32'),
        ('$8,262.94', '$8,022.65'),
        ('$20,657.35', '$20,056.62'),
        ('$41,314.70', '$40,113.24'),
        ('$10,553.63', '$10,536.33'),
        ('$21,107.27', '$21,072.66'),
        ('$52,768.17', '$52,681.66'),
        ('$105,536.33', '$105,363.32'),
    ],
    35: [  # 10 years lump sum
        ('$3,767.86', '$3,658.44'),
        ('$7,535.73', '$7,316.87'),
        ('$18,839.31', '$18,292.19'),
        ('$37,678.63', '$36,584.37'),
        ('$27,232.14', '$27,187.50'),
        ('$54,464.29', '$54,375.00'),
        ('$136,160.71', '$135,937.50'),
        ('$272,321.43', '$271,875.00'),
    ],
    36: [  # 20 years lump sum
        ('$3,137.50', '$3,045.92'),
        ('$6,275.01', '$6,091.85'),
        ('$15,687.52', '$15,229.62'),
        ('$31,375.04', '$30,459.23'),
        ('$77,215.19', '$77,088.61'),
        ('$154,430.38', '$154,177.22'),
        ('$386,075.95', '$385,443.04'),
        ('$772,151.90', '$770,886.08'),
    ],
    37: [  # 30 years lump sum
        ('$2,438.87', '$2,367.68'),
        ('$4,877.74', '$4,735.36'),
        ('$12,194.35', '$11,838.41'),
        ('$24,388.69', '$23,676.81'),
        # These stay the same (based on Nasdaq-100 index ratio, not QQQ price)
    ],
    39: [  # 5 years DCA
        ('$4,957.76', '$4,813.59'),
        ('$12,394.41', '$12,033.97'),
        ('$24,788.82', '$24,067.94'),
        ('$49,577.64', '$48,135.88'),
        ('$8,573.35', '$8,567.05'),
        ('$21,433.38', '$21,417.64'),
        ('$42,866.77', '$42,835.27'),
        ('$85,733.53', '$85,670.55'),
    ],
    40: [  # 10 years DCA
        ('$9,042.87', '$8,780.25'),
        ('$22,607.18', '$21,950.62'),
        ('$45,214.35', '$43,901.25'),
        ('$90,428.71', '$87,802.50'),
        ('$25,137.82', '$25,122.44'),
        ('$62,844.54', '$62,806.11'),
        ('$125,689.09', '$125,612.22'),
        ('$251,378.17', '$251,224.44'),
    ],
    41: [  # 20 years DCA
        ('$15,060.02', '$14,620.43'),
        ('$37,650.05', '$36,551.08'),
        ('$75,300.10', '$73,102.16'),
        ('$150,600.19', '$146,204.31'),
        ('$70,970.00', '$70,934.58'),
        ('$177,424.99', '$177,336.46'),
        ('$354,849.98', '$354,672.92'),
        ('$709,699.97', '$709,345.84'),
    ],
    42: [  # 30 years DCA
        ('$17,559.86', '$17,047.30'),
        ('$43,899.65', '$42,618.26'),
        ('$87,799.30', '$85,236.52'),
        ('$175,598.60', '$170,473.04'),
        # Investment values stay the same
    ],
}

def update_slide(slide_num, replacements):
    """Update a slide with the given replacements"""
    slide_path = f'pptx_corrected/ppt/slides/slide{slide_num}.xml'

    if not os.path.exists(slide_path):
        print(f"Warning: {slide_path} not found")
        return False

    with open(slide_path, 'r', encoding='utf-8') as f:
        content = f.read()

    changes = 0
    for old, new in replacements:
        if old != new and old in content:
            count = content.count(old)
            content = content.replace(old, new)
            changes += count
            print(f"  Slide {slide_num}: '{old}' -> '{new}' ({count}x)")

    with open(slide_path, 'w', encoding='utf-8') as f:
        f.write(content)

    print(f"Slide {slide_num}: {changes} changes")
    return True

print("="*80)
print("FINAL CORRECTED UPDATE")
print("Using CPI Sep 2025 = 324.368 (verified)")
print("="*80)

for slide_num in sorted(slide_replacements.keys()):
    print(f"\nSlide {slide_num}...")
    update_slide(slide_num, slide_replacements[slide_num])

print("\n" + "="*80)
print("ALL SLIDES UPDATED WITH CORRECTED VALUES")
print("="*80)
